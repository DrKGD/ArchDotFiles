

set $leader Mod4
set $bgimage $HOME/.config/i3/space.jpg
set $sk $HOME/.config/i3/sk
set $border_size 3
set $gap_outer 10
set $gap_inner 8
set $workspace_social Social
set $workspace_media Media
set $workspace_focusi "Focus I"
set $workspace_termi "Term I"
set $workspace_termii "Term II"
set $workspace_focusii "Focus II"
set $workspace_nav Nav
set $workspace_misc Misc
set $workspace_setup Setup
set $workspace_gaming Gaming
set $apps_browser firefox
set $apps_incognito firefox --private-window --
set $apps_terminal wezterm
set $apps_cwdTerminal wezterm start --cwd $(cat $MOUNTPOINT/cwd)
set $apps_editor vscode
set $apps_fileExplorer dolphin
set $apps_whatsapp firefox --new-window https://web.whatsapp.com
set $mode_run run
set $mode_media media
set $mode_system sudo
set $mode_edit edit
set $color_focus #FC0344
set $color_elegible #750A26
set $color_nofocus #520016
set $color_urgent #FD5D88
set $color_indicator #FD5D88
set $color_elgindicator #FC0344
set $color_unknown #000000
set $dimamount 0.35
set $output_sx_screen DP-1
set $output_sx_gaps_top 5
set $output_sx_gaps_left 5
set $output_sx_gaps_right 5
set $output_sx_gaps_bottom 25
set $output_cx_screen DVI-I-1
set $output_cx_gaps_top 30
set $output_cx_gaps_left 5
set $output_cx_gaps_right 5
set $output_cx_gaps_bottom 28
set $output_dx_screen HDMI-0
set $output_dx_gaps_top 5
set $output_dx_gaps_left 5
set $output_dx_gaps_right 5
set $output_dx_gaps_bottom 25
set $output_tv_screen DVI-D-0
#######################################################
## i3 - Run-on-startup applications									 ##
#######################################################

# Current working directory
exec_always --no-startup-id (killall -9 i3cwd.sh || true) && $HOME/.config/i3/sk/i3cwd.sh $MOUNTPOINT/cwd

# Compositor (picom) 
exec_always --no-startup-id "picom -b --backend glx --experimental-backends"

# Static background img 
exec_always --no-startup-id xwallpaper --no-randr --tile $bgimage

# alttab utility 
exec_always --no-startup-id "alttab -d 0 -p none -font \"xft:scientifica-12\" -t 128x60 -i 128x40 -fg \"#179aff\" -frame \"#ff9507\""

# polybar (do not refresh configuration)
exec_always --no-startup-id "$HOME/.config/polybar/launch.sh n" 

#######################################################
## i3 - Appearance																	 ##
#######################################################

## Gaps, Borders
for_window [class=".*"] border pixel $border_size 
hide_edge_borders both 

# Global configuration
gaps outer $gap_outer
gaps inner $gap_inner

## Colors
# class										border					backgr					text						indicator					child_border
client.focused						$color_unknown	$color_unknown	$color_unknown	$color_indicator $color_focus	
client.focused_inactive 	$color_unknown 	$color_unknown	$color_unknown	$color_elgindicator $color_elegible
client.unfocused					$color_unknown 	$color_unknown	$color_unknown 	$color_unknown		$color_nofocus
client.urgent							$color_unknown	$color_unknown	$color_unknown 	$color_urgent			$color_urgent
client.placeholder				$color_unknown	$color_unknown	$color_unknown	$color_unknown		$color_unknown
client.background					$color_unknown


#######################################################
## i3 - Global defined keybindings									 ##
#######################################################

## Mouse
floating_modifier $leader
focus_follows_mouse no 

## Allow moving between monitors
force_focus_wrapping no

# Don't move mouse on focus change
mouse_warping none

## Change focus
bindsym $leader+h focus left
bindsym $leader+j focus down
bindsym $leader+k focus up
bindsym $leader+l focus right

## Move windows around around
bindsym $leader+Shift+h move left
bindsym $leader+Shift+j move down
bindsym $leader+Shift+k move up
bindsym $leader+Shift+l move right

# Run program
bindsym $leader+slash exec "rofi -modi drun,run -show drun"

# Show programs
bindsym $leader+Tab exec rofi -show window

# Enter fullscreen
bindsym $leader+f fullscreen toggle

# Toggle floating 
bindsym $leader+Return floating toggle

# Kill current focussed window
bindsym $leader+q kill
bindsym $keys_alt+F4 kill

# Reload xrdb current profile
set_from_resource $xrdbconfig	de.configuration $HOME/.config/xrdb/profile/desktop

# Reload configuration
bindsym $leader+grave exec --no-startup-id $HOME/.config/i3/sk/reload.sh reload
bindsym $leader+Shift+grave exec --no-startup-id $HOME/.config/i3/sk/reload.sh restart 

# Split vertical or horizontal 
bindsym $leader+v split h
bindsym $leader+s split v 

## Volume Control
# Use pactl to adjust volume in PulseAudio
set $refresh_i3status killall -SIGUSR1 i3status
bindsym XF86AudioRaiseVolume exec --no-startup-id $sk/volume_sanification.sh @DEFAULT_SINK@ +5
bindsym XF86AudioLowerVolume exec --no-startup-id $sk/volume_sanification.sh @DEFAULT_SINK@ -5
bindsym XF86AudioMute exec --no-startup-id pactl set-sink-mute @DEFAULT_SINK@ toggle && $refresh_i3status
bindsym XF86AudioMicMute exec --no-startup-id pactl set-source-mute @DEFAULT_SOURCE@ toggle && $refresh_i3status

# Use keyboard
bindsym $leader+equal exec --no-startup-id $sk/volume_sanification.sh @DEFAULT_SINK@ +4
bindsym $leader+minus exec --no-startup-id $sk/volume_sanification.sh @DEFAULT_SINK@ -4

# Cycle through workspace(s) on the current screen
bindsym $leader+bracketleft workspace prev_on_output
bindsym $leader+bracketright workspace next_on_output

# TODO: Handle screenshots in i3


#######################################################
## i3 - Modes and modal keybindings									 ##
#######################################################

## Modes
# Run binded applications
bindsym $leader+r mode $mode_run
mode $mode_run {
		# Run explorer 
		bindsym e exec $apps_fileExplorer, mode "default"

		# Telegram 
		bindsym t exec telegram-desktop, mode "default"

		# Terminal
		bindsym Return exec $apps_terminal, mode "default"
		bindsym Shift+Return exec $apps_cwdTerminal, mode "default"

		# Whatsapp 
		bindsym w exec $apps_whatsapp, mode "default"

		# Browser
		bindsym b exec $apps_browser, mode "default"

		# Browser in incognito 
		bindsym Shift+b exec $apps_incognito, mode "default"

		# Exit
		bindsym Escape mode "default"
	}
 
# Media (music, youtube ...) control
bindsym $leader+p mode $mode_media
mode $mode_media {
		# Player play-pause 
		bindsym space exec playerctl play-pause 

		# Player control
		bindsym Right exec playerctl next
		bindsym Left exec playerctl previous

		# Volume Control
		bindsym equal exec playerctl volume +5
		bindsym minus exec playerctl volume -5

		# Exit
		bindsym Escape mode "default"
	}

# System commands
bindsym $leader+$shift+r mode $mode_system
mode $mode_system {
		# Volume Control
		bindsym equal exec --no-startup-id $sk/volume_sanification.sh @DEFAULT_SINK@ +4
		bindsym minus exec --no-startup-id $sk/volume_sanification.sh @DEFAULT_SINK@ -4

		# logout 
		bindsym s exec "i3-nagbar -t warning -m 'Do you really want to shutdown the computer?' -B 'Yes' 'shutdown -h now'"
		bindsym l exec "i3-nagbar -t warning -m 'Do you really want to logout?' -B 'Yes' 'i3-msg exit'"

		bindsym Return mode "default"
		bindsym Escape mode "default"
		bindsym $leader+Escape mode "default"
	}

# Edit (resize 'n such)
bindsym $leader+e mode $mode_edit
mode $mode_edit {
		# These bindings trigger as soon as you enter the resize mode

		# Pressing left will shrink the window’s width.
		# Pressing right will grow the window’s width.
		# Pressing up will shrink the window’s height.
		# Pressing down will grow the window’s height.
		bindsym h resize shrink width 10 px or 10 ppt
		bindsym j resize grow height 10 px or 10 ppt
		bindsym k resize shrink height 10 px or 10 ppt
		bindsym l resize grow width 10 px or 10 ppt

		# same bindings, but for the arrow keys
		bindsym Left resize shrink width 10 px or 10 ppt
		bindsym Down resize grow height 10 px or 10 ppt
		bindsym Up resize shrink height 10 px or 10 ppt
		bindsym Right resize grow width 10 px or 10 ppt

		# back to normal: Enter or Escape or $mod+r
		bindsym Return mode "default"
		bindsym Escape mode "default"
		bindsym $leader+e mode "default"
	}


#######################################################
## i3 - Desktop specific settings										 ##
#######################################################
## i3 - Specific bindings        										 ##
#######################################################

## Move to the next output
bindsym $leader+Left exec --no-startup-id "i3-msg 'focus output left'"
bindsym $leader+Right exec  --no-startup-id "i3-msg 'focus output right'"

## Move container to the next output (and keep focus)
bindsym $leader+Shift+Left exec  --no-startup-id "i3-msg 'move container to output left; focus output left'"
bindsym $leader+Shift+Right exec  --no-startup-id "i3-msg 'move container to output right; focus output right'"

#######################################################
## i3 - Workspaces and all        									 ##
#######################################################

## Modals
set $eggwl sx
set $eggwm cx
set $eggwr dx

bindsym $leader+1 mode $eggwl; exec --no-startup-id "$sk/brightness.sh $dimamount $output_tv_screen $output_sx_screen"
bindsym $leader+2 mode $eggwm; exec --no-startup-id "$sk/brightness.sh $dimamount $output_tv_screen $output_cx_screen"
bindsym $leader+3 mode $eggwr; exec --no-startup-id "$sk/brightness.sh $dimamount $output_tv_screen $output_dx_screen"

## Left Monitor 
workspace $workspace_social	 output $output_sx_screen
workspace $workspace_media	 output $output_sx_screen
workspace $workspace_focusi	 output $output_sx_screen

assign [class="TelegramDesktop"] $workspace_social
for_window [class="firefox" title="^WhatsApp — Mozilla Firefox$"] move to workspace $workspace_social
assign [class="discord"] $workspace_media

workspace $workspace_social	gaps top		$output_sx_gaps_top
workspace $workspace_social	gaps left		$output_sx_gaps_left
workspace $workspace_social	gaps right	$output_sx_gaps_right
workspace $workspace_social	gaps bottom $output_sx_gaps_bottom

workspace $workspace_media	gaps top		$output_sx_gaps_top
workspace $workspace_media	gaps left		$output_sx_gaps_left
workspace $workspace_media	gaps right	$output_sx_gaps_right
workspace $workspace_media	gaps bottom $output_sx_gaps_bottom

workspace $workspace_focusi	gaps top		$output_sx_gaps_top
workspace $workspace_focusi	gaps left		$output_sx_gaps_left
workspace $workspace_focusi	gaps right	$output_sx_gaps_right
workspace $workspace_focusi	gaps bottom $output_sx_gaps_bottom

## Central Monitor
workspace $workspace_termi	 output $output_cx_screen
workspace $workspace_termii	 output $output_cx_screen
workspace $workspace_focusii output $output_cx_screen
workspace $workspace_gaming	 output $output_cx_screen

assign [class="gzdoom"] $workspace_gaming

workspace $workspace_termi		gaps top		$output_cx_gaps_top
workspace $workspace_termi		gaps left		$output_cx_gaps_left
workspace $workspace_termi		gaps right	$output_cx_gaps_right
workspace $workspace_termi		gaps bottom $output_cx_gaps_bottom

workspace $workspace_termii		gaps top		$output_cx_gaps_top
workspace $workspace_termii		gaps left		$output_cx_gaps_left
workspace $workspace_termii		gaps right	$output_cx_gaps_right
workspace $workspace_termii		gaps bottom $output_cx_gaps_bottom

workspace $workspace_focusii	gaps top		$output_cx_gaps_top
workspace $workspace_focusii	gaps left		$output_cx_gaps_left
workspace $workspace_focusii	gaps right	$output_cx_gaps_right
workspace $workspace_focusii	gaps bottom $output_cx_gaps_bottom

workspace $workspace_gaming		gaps top		$output_cx_gaps_top
workspace $workspace_gaming		gaps left		$output_cx_gaps_left
workspace $workspace_gaming		gaps right	$output_cx_gaps_right
workspace $workspace_gaming		gaps bottom $output_cx_gaps_bottom

## Right Monitor
workspace $workspace_nav	 output $output_dx_screen
workspace $workspace_misc	 output $output_dx_screen
workspace $workspace_setup output $output_dx_screen

workspace $workspace_nav				gaps top		$output_dx_gaps_top
workspace $workspace_nav				gaps left		$output_dx_gaps_left
workspace $workspace_nav				gaps right	$output_dx_gaps_right
workspace $workspace_nav				gaps bottom $output_dx_gaps_bottom

workspace $workspace_misc		gaps top		$output_dx_gaps_top
workspace $workspace_misc		gaps left		$output_dx_gaps_left
workspace $workspace_misc		gaps right	$output_dx_gaps_right
workspace $workspace_misc		gaps bottom $output_dx_gaps_bottom

workspace $workspace_setup	gaps top		$output_dx_gaps_top
workspace $workspace_setup	gaps left		$output_dx_gaps_left
workspace $workspace_setup	gaps right	$output_dx_gaps_right
workspace $workspace_setup	gaps bottom $output_dx_gaps_bottom


#######################################################
## i3 - Modals bindings           									 ##
#######################################################

# Left
mode $eggwl {
	bindsym 1 workspace $workspace_social; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	bindsym 2 workspace $workspace_media; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	bindsym 3 workspace $workspace_focusi; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"

	bindsym $leader+1 workspace $workspace_social; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	bindsym $leader+2 workspace $workspace_media; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	bindsym $leader+3 workspace $workspace_focusi; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"

	bindsym Shift+1 move container to workspace $workspace_social; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	bindsym Shift+2 move container to workspace $workspace_media; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	bindsym Shift+3 move container to workspace $workspace_focus; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"

	bindsym $leader+Shift+1 move container to workspace $workspace_social; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	bindsym $leader+Shift+2 move container to workspace $workspace_media; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	bindsym $leader+Shift+3 move container to workspace $workspace_focusi; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	# Exit
	bindsym Escape mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
}

# Center 
mode $eggwm {
	bindsym 1 workspace $workspace_termi; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	bindsym 2 workspace $workspace_termii; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	bindsym 3 workspace $workspace_focusii; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	bindsym 4 workspace $workspace_gaming; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"

	bindsym $leader+1 workspace $workspace_termi; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	bindsym $leader+2 workspace $workspace_termii; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	bindsym $leader+3 workspace $workspace_focusii; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	bindsym $leader+4 workspace $workspace_gaming; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"

	bindsym Shift+1 move container to workspace $workspace_termi; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	bindsym Shift+2 move container to workspace $workspace_termii; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	bindsym Shift+3 move container to workspace $workspace_focusii; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	bindsym Shift+4 move container to workspace $workspace_gaming; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	
	bindsym $leader+Shift+1 move container to workspace $workspace_termi; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	bindsym $leader+Shift+2 move container to workspace $workspace_termii; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	bindsym $leader+Shift+3 move container to workspace $workspace_focusii; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	bindsym $leader+Shift+4 move container to workspace $workspace_gaming; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"

	# Exit
	bindsym Escape mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
}


# Right 
mode $eggwr {
	bindsym 1 workspace $workspace_nav; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	bindsym 2 workspace $workspace_misc; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	bindsym 3 workspace $workspace_setup; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"

	bindsym $leader+1 workspace $workspace_nav; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	bindsym $leader+2 workspace $workspace_misc; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	bindsym $leader+3 workspace $workspace_setup; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"

	bindsym Shift+1 move container to workspace $workspace_nav; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	bindsym Shift+2 move container to workspace $workspace_misc; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	bindsym Shift+3 move container to workspace $workspace_setup; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	
	bindsym $leader+Shift+1 move container to workspace $workspace_nav; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	bindsym $leader+Shift+2 move container to workspace $workspace_misc; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
	bindsym $leader+Shift+3 move container to workspace $workspace_setup; mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"

	# Exit
	bindsym Escape mode "default"; exec --no-startup-id "$sk/brightness.sh 1 $output_tv_screen"
}

